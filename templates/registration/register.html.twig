{% extends 'base.html.twig' %}

{% block title %}S'enregistrer
{% endblock %}

{% block body %}
	<div class="container py-3" style="margin-top: 100px; margin-bottom: 100px">
		<div class="row">
			<div class="col-12 mt-1">

				<h1>S'enregistrer</h1>

				{{ form_start(registrationForm) }}
				{{ form_row(registrationForm.name) }}
				{{ form_row(registrationForm.telephone) }}
				{{ form_row(registrationForm.adresse) }}
				{{ form_row(registrationForm.email) }}
				{{ form_row(registrationForm.plainPassword, {
            label: 'Password'
        }) }}
				{{ form_row(registrationForm.agreeTerms) }}

				<button type="submit" class="btn btn-success btn-xs">S'inscrire</button>
				{{ form_end(registrationForm) }}
			</div>
			<div class="typeRegisterContraint pt-3 row">

				<p class="fw-lighter text-medium-grey col-4" id='contraintLength'>
					<i class="fa-solid fa-circle-check pe-2 fw-lighter"></i>8 Caractères minimum</p>
				<p class="fw-lighter text-medium-grey col-4" id='contraintMajuscule'>
					<i class="fa-regular fa-circle-check pe-2"></i>Au moins une lettre majuscule</p>
				<p class="fw-lighter text-medium-grey col-4" id='contraintChiffre'>
					<i class="fa-regular fa-circle-check pe-2"></i>Au moins un chiffre</p>

				<!-- <p class="fw-lighter text-medium-grey " id='contraintSpecial'></p> -->
			</div>
		</div>


		<style>
			/* Style all input fields */
			input {
				width: 100%;
				padding: 12px;
				border: 1px solid #ccc;
				border-radius: 4px;
				box-sizing: border-box;
				margin-top: 6px;
				margin-bottom: 16px;
			}

			/* Style the submit button */
			input[type=submit] {
				background-color: #04AA6D;
				color: white;
			}

			/* Style the container for inputs */
			.container {
				background-color: #f1f1f1;
				padding: 20px;
			}

			/* The message box is shown when the user clicks on the password field */
			#message {
				display: none;
				background: #f1f1f1;
				color: #000;
				position: relative;
				padding: 20px;
				margin-top: 10px;
			}

			#message p {
				padding: 10px 35px;
				font-size: 18px;
			}

			/* Add a green text color and a checkmark when the requirements are right */
			.valid {
				color: green;
			}

			.valid:before {
				position: relative;
				left: -35px;
				content: "✔";
			}

			/* Add a red text color and an "x" when the requirements are wrong */
			.invalid {
				color: red;
			}

			.invalid:before {
				position: relative;
				left: -35px;
				content: "✖";
			}
		</style>

		<h3>Password Validation</h3>
		<p>Try to submit the form.</p>

		<div class="container" style="margin-top: 100px; margin-bottom: 100px">
			<form action="/action_page.php">
				<label for="usrname">Username</label>
				<input type="text" id="usrname" name="usrname" required>

				<label for="psw">Password</label>
				<input type="password" id="psw" name="psw" pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}" title="Must contain at least one number and one uppercase and lowercase letter, and at least 8 or more characters" required>

				<input type="submit" value="Submit">
			</form>
		</div>

		<div id="message">
			<h3>Password must contain the following:</h3>
			<p id="letter" class="invalid">A
				<b>lowercase</b>
				letter</p>
			<p id="capital" class="invalid">A
				<b>capital (uppercase)</b>
				letter</p>
			<p id="number" class="invalid">A
				<b>number</b>
			</p>
			<p id="length" class="invalid">Minimum
				<b>8 characters</b>
			</p>
		</div>

		<div>
			<p>Click the radio button to toggle between password visibility:</p>


			Password:
			<input type="password" value="FakePSW" id="myInput"><br>
			<input type="checkbox" onclick="myFunction()">
			Show Password
		</div>
	</div>

	<script>
		function myFunction() {
var x = document.getElementById("myInput");
if (x.type === "password") {
x.type = "text";
} else {
x.type = "password";
}
}
	</script>

	<script>
		var myInput = document.getElementById("psw");
var letter = document.getElementById("letter");
var capital = document.getElementById("capital");
var number = document.getElementById("number");
var length = document.getElementById("length");

// When the user clicks on the password field, show the message box
myInput.onfocus = function () {
document.getElementById("message").style.display = "block";
}

// When the user clicks outside of the password field, hide the message box
myInput.onblur = function () {
document.getElementById("message").style.display = "none";
}

// When the user starts to type something inside the password field
myInput.onkeyup = function () { // Validate lowercase letters
var lowerCaseLetters = /[a-z]/g;
if (myInput.value.match(lowerCaseLetters)) {
letter.classList.remove("invalid");
letter.classList.add("valid");
} else {
letter.classList.remove("valid");
letter.classList.add("invalid");
}

// Validate capital letters
var upperCaseLetters = /[A-Z]/g;
if (myInput.value.match(upperCaseLetters)) {
capital.classList.remove("invalid");
capital.classList.add("valid");
} else {
capital.classList.remove("valid");
capital.classList.add("invalid");
}

// Validate numbers
var numbers = /[0-9]/g;
if (myInput.value.match(numbers)) {
number.classList.remove("invalid");
number.classList.add("valid");
} else {
number.classList.remove("valid");
number.classList.add("invalid");
}

// Validate length
if (myInput.value.length >= 8) {
length.classList.remove("invalid");
length.classList.add("valid");
} else {
length.classList.remove("valid");
length.classList.add("invalid");
}
}
	</script>


	<script>
		const inputPassword = document.getElementById('registration_form_plainPassword_first');
const contraintLength = document.getElementById('contraintLength');
const contraintMajuscule = document.getElementById('contraintMajuscule');
const contraintChiffre = document.getElementById('contraintChiffre');
const contraintSpecial = document.getElementById('contraintSpecial');

const checkLength = (item) => {
if (item >= 8 && item <= 40) {
contraintLength.classList.add('textGreen');

} else {
contraintLength.classList.remove('textGreen');
}
}

const checkMajuscule = (item) => {
if (item.match(new RegExp("[A-Z]"))) {
contraintMajuscule.classList.add('textGreen');
} else {
contraintMajuscule.classList.remove('textGreen');

}
}

const checkChiffre = (item) => {
if (item.match(new RegExp("[0-9]"))) {

contraintChiffre.classList.add('textGreen');
} else {
contraintChiffre.classList.remove('textGreen');

}
} inputPassword.addEventListener('keyup', () => {
let actualLength = inputPassword.value.length;
// console.log(actualLength);
checkLength(actualLength);

let inputValue = inputPassword.value;
checkMajuscule(inputValue);
checkChiffre(inputValue);
})
	</script>

{% endblock %}
